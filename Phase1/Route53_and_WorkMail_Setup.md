---
title: "AWS Route53 and WorkMail Setup – Virtual Agentics"
status: "Stable Draft"
audience: "Internal (DevOps, Security, Ops); External (Auditors, Stakeholders)"
authors: "VirtualAgentics Core Team (generated by ChatGPT GPT-4.5, curated by Ben)"
version: "1.0"
date: "2025-06-06"
gpt_model: "Drafted by GPT-4.5 Deep Research"
---

# AWS Route53 and WorkMail Setup: Virtual Agentics

## Purpose

This document describes the setup and configuration of DNS (Route53) and managed mail (WorkMail) for the Virtual Agentics organization, including domain verification, mailbox creation, and integration with other AWS services. All changes are made via Terraform/IaC where possible and are version-controlled.

---

## 1. Prerequisites

- **AWS root/management account** with Route53 and WorkMail permissions
- **Registered domain**: `virtualagentics.ai` (with access to registrar for NS changes)
- **Terraform and AWS CLI** available for automation
- Refer to [DNS_Zones.md](../DNS_Zones.md) and [Naming_Conventions.md](../Naming_Conventions.md) for consistent naming

---

## 2. Route53 Public Hosted Zone Setup

### Terraform Example: DNS Records in Route53

```hcl
resource "aws_route53_record" "mx_record" {
  zone_id = aws_route53_zone.main.zone_id
  name    = "virtualagentics.ai"
  type    = "MX"
  ttl     = "300"
  records = ["10 inbound-smtp.eu-central-1.amazonaws.com"]
}

resource "aws_route53_record" "txt_verification" {
  zone_id = aws_route53_zone.main.zone_id
  name    = "_amazonses.virtualagentics.ai"
  type    = "TXT"
  ttl     = "300"
  records = [""verification-string-from-ses""]
}

resource "aws_route53_record" "cname_www" {
  zone_id = aws_route53_zone.main.zone_id
  name    = "www.virtualagentics.ai"
  type    = "CNAME"
  ttl     = "300"
  records = ["distribution123.cloudfront.net"]
}
```


1. **Create public hosted zone** for `virtualagentics.ai` in Route53 (prod account)
2. **Copy NS and SOA records** to your registrar’s portal to delegate domain to Route53
3. **Add base records** (A/AAAA, MX, TXT, CNAME) for:
    - Web endpoints (e.g., `www.virtualagentics.ai` → CloudFront/S3)
    - API endpoints (e.g., `api.prod.virtualagentics.ai`)
    - WorkMail/SES records (see below)
4. **Configure subdomain zones** if needed for `prod`, `dev`, `shared`, `sandbox` (see [DNS_Zones.md](../DNS_Zones.md))

---

## 3. WorkMail Organization and Mailbox Setup

### Terraform Example: WorkMail Email Alias Automation

```hcl
resource "aws_workmail_alias" "prod_alias" {
  organization_id = aws_workmail_organization.main.id
  entity_id       = aws_workmail_user.info.id
  alias           = "prod@virtualagentics.ai"
}

resource "aws_workmail_alias" "audit_alias" {
  organization_id = aws_workmail_organization.main.id
  entity_id       = aws_workmail_user.info.id
  alias           = "audit@virtualagentics.ai"
}
```


1. **Create AWS WorkMail organization** in the prod/shared account (eu-central-1)
2. **Add domain** `virtualagentics.ai` to WorkMail
3. **Follow WorkMail wizard to verify domain**:
    - Add required MX and TXT records to Route53
    - (Optional: Add DKIM/DMARC records for improved deliverability)
4. **Create primary mailbox:** `info@virtualagentics.ai`
5. **Set up aliases:** (e.g., `prod@virtualagentics.ai`, `audit@virtualagentics.ai`, `dev@virtualagentics.ai`, etc.) to route all AWS account notifications, billing, and agent role addresses to the relevant inbox(es)
6. **Configure user access:** Grant access to mailboxes to operations/IT users as needed

---

## 4. SES (Simple Email Service) Integration

### Email Flow Diagram (WorkMail ↔️ Route53 ↔️ SES)

```mermaid
graph TD;
  User["External User/Service"]
  SES["SES (Outbound SMTP)"]
  Route53["Route53 DNS (virtualagentics.ai)"]
  WorkMail["WorkMail (virtualagentics.ai)"]
  
  User -->|Inbound Email (MX record)| Route53
  Route53 -->|Route to Mailbox| WorkMail
  WorkMail -->|Fetch Email| InternalUser["Internal User"]
  
  InternalUser -->|Send Email| WorkMail
  WorkMail -->|Outbound SMTP| SES
  SES -->|DNS Records (TXT, DKIM)| Route53
  SES --> User
```


- **SES for transactional mail:** (notifications, agent comms, alerts)
- **Domain verification**: Add SES-supplied TXT records to Route53
- **Email sending:** Lambda and agent workflows use SES API with appropriate IAM permissions
- **IAM policy example** for Lambda/agent to send email:

```json
{
  "Effect": "Allow",
  "Action": [
    "ses:SendEmail",
    "ses:SendRawEmail"
  ],
  "Resource": "*"
}
```

- **DKIM/DMARC setup:** Add SES-generated DNS records for authentication

---

## 5. Mail Routing and Automation

- **AWS Account Root/Billing email addresses**: Each account uses unique alias (e.g., `prod@virtualagentics.ai`, `audit@virtualagentics.ai`); WorkMail routes to shared mailbox or individual as needed
- **Aliases for agent and system notifications:** (e.g., `cfo@virtualagentics.ai`, `alerts@virtualagentics.ai`)
- **Mail forwarding and rules:** Configured in WorkMail console for internal distribution or external forwarding as required

---

## 6. Monitoring, Security, and Compliance

- **CloudWatch monitoring** for SES sending limits, bounce/complaint rates
- **WorkMail audit logs** enabled for access tracking
- **Least-privilege IAM**: Only necessary Lambda/agents have SES/WorkMail permissions
- **No personal mailboxes** for agent IDs unless justified/audited

---

## 7. Change Control and Documentation

- All DNS/mail config tracked in Terraform/IaC (`virtualagentics-iac`)
- No manual Route53 or WorkMail changes unless backported to code and documentation
- All alias and mailbox changes require PR/approval and update to this file

---

## 8. References

- [DNS_Zones.md](../DNS_Zones.md)
- [Naming_Conventions.md](../Naming_Conventions.md)
- [Technical_Specification_v1.md](../Technical_Specification_v1.md)
- Source: "AWS Route53 & WorkMail Setup for VirtualAgentics Mailbox.pdf"

---

*End of document*
